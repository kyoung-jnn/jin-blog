---
title: React, Portal 이란?, Modal 만들기
date: '2022-05-13'
summary: React, Portal로 원하는 곳으로 컴포넌트 이동시키기
publish: true
---

# 🚪 React, Portal 이란?

```javascript
const Parent = ({ children }) => {
  return <>{children}</>; // 항상 부모 밑에 존재
};
```

**Portal**은 **React v16** 부터 지원된 꽤 오래된? 기능입니다.
기존의 자식 컴포넌트는 항상 부모 컴포넌트의 **DOM 구조의 종속**되어 왔습니다.

```javascript
const Parent = ({ children }) => {
  return ReactDOM.createPortal(children, '원하는 DOM 노드');
};
```

`Portal`을 이용하면 기존의 **부모 DOM 구조의 바깥**에 있는 **DOM 노드**에 **자식(컴포넌트)를 렌더링**할 수 있게 해줍니다.

<Image src={'/posts/2022/05/react-portal/code.png'} width="720" height="150" />

`createPortal` 함수의 `2번째 인자`로 **Ref 객체, document로 찾은 DOM 노드**를 제공하면, `1번째 인자`로 제공된 **컴포넌트**가 **해당 위치(DOM)** 에 렌더링되는 방식입니다.

<Image
  src={'/posts/2022/05/react-portal/portal2.jpg'}
  width={400}
  height={200}
/>

기본적으로 `Portal`은 **서로 다른 위치를 연결해주는 문 (포탈 게임 🤓)** 이라는 통용적인 의미를 갖고 있는데, 이러한 의미를 활용하여 아래와 같이 이해했습니다.

> **렌더링할 컴포넌트**를 `Portal`이란 **문**을 통해
> **원하는 DOM 노드**에 부착한다!

## 🤔 어디다 사용할까?

기존의 **DOM** 트리에서 벗어나 **원하는 DOM 위치에서 독자적인 렌더링이 필요할 때**가 있을까요?

바로 흔히 사용하는 **Modal**에 이러한 방식을 사용할 수 있습니다.

기존의 **Modal**이 사용되는 위치인 **부모 컴포넌트** 속 동작을 생각해보면

- 모달이 활성화 되었을 때, 부모에서 업데이트가 일어나면 **모달도 영향**을 받는다.
- 간단한 모달인 경우에도 **모달에 필요없는 전역 상태**를 갖게 된다.
- 부모 컴포넌트의 스타일 때문에, `z-index` 조절을 해줘야한다.

위와 같은 **문제점**을 갖을 수 있게 됩니다.

> 따라서, **Modal** 제작에 `Portal`을 활용하여 **부모-자식 간의 DOM 종속을 회피**하여 문제점을 방지할 수 있습니다.

## ✨ Modal 코드

### index

```html
<html lang="en">
  <body>
    <div id="root"></div>
    <div id="modal-root"></div>
  </body>
</html>
```

위와 같이 `index.html`에 **모달을 위한 DOM 노드**를 지정해둡니다.

### ModalPortal & Modal

```js
const ModalPortal = ({ children }) => {
  const modalRoot = document.getElementById('modal-root');
  return ReactDOM.createPortal(children, modalRoot);
};

const Modal = ({ setModalState }) => {
  return (
    <div>
      <h1>모달</h1>
      <button onClick={() => setModalState(false)}>모달 끄기</button>
    </div>
  );
};
```

**원하는 위치로 (`# modal-root`)** 컴포넌트를 보내줄 `Portal`을 만듭니다!

임의의 **Modal** 또한 구현했습니다.

### App

```js
function App() {
  const [modalState, setModalState] = useState(false);

  return (
    <>
      <button onClick={() => setModalState(true)}>모달 버튼</button>
      {modalState && (
        <ModalPortal>
          <Modal />
        </ModalPortal>
      )}
    </>
  );
}
```

이제 만들어진 **Modal**을 `Portal`로 감싸게 되면 끝입니다! 👍

해당 `Portal`을 통해 모달은 더이상 **APP 컴포넌트 하위에 존재하지 않습니다!**

`Portal` 이라는 문을 통해서 사용자가 지정한 공간, 위치로 이동한거죠 😁

## ❗️ 주의

`Portal`을 통해서 **DOM** 트리 어디든지 존재할 수 있지만,

결국, **React**의 **부모-자식 관계**는 유지하기 때문에 **이벤트 버블링, 상태 관리(state)** 등의 영향은 그대로 받게 됩니다!

- **DOM**에서는 다른 곳에 **Modal**이 위치

<Image src={'/posts/2022/05/react-portal/shot1.png'} width="250" height="200" />

- **React**에서는 **부모-자식 관계** 유지 😎

<Image src={'/posts/2022/05/react-portal/shot2.png'} width="200" height="100" />

따라서, 위 코드의 **useState**로 인한 상태 변화를 `Portal`로 인해 다른 **DOM** 에 존재하는 **Modal**이 인지할 수 있습니다!
